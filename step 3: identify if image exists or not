import pandas as pd
import os


df = pd.read_csv('MR_test_withcolnames.txt', delimiter='\t', header=0,)

#check column names
print("Original Column Names:")
print(df.columns)

#defining which column image file is in and what directory needs to check to see if file is tehre
image_col= 'image_file'    
image_directory= "C:/Users/ychen/Desktop"        #change directory later 

#check if file is in folder/directory
def check(image_file):
  file_path = os.path.join(image_directory, image_file)
  return "EXIST" if os.path.isfile(file_path) else "NO"

#add column that states if file exists or not
df['file_status'] = df['image_file'].apply(check)

#lines 24-28 are to filter out the rows that exist and save it to a separate file
df_exist = df[df['file_status'] == 'EXIST']

# Save the filtered DataFrame to a new CSV file
filtered_csv_file_path = 'MR_sub_exist_month.txt'
df_exist.to_csv(filtered_csv_file_path, index=False)


#save the new file (has both exist and non existent rows)
df.to_csv('MR_sub_exist_and_nonexist_month.txt', sep='\t', index=False)

  

